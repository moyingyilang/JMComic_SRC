{"version":3,"file":"static/js/98.6bb517b0.chunk.js","mappings":"4SAeA,MA4KA,EA5KgBA,KAAO,IAADC,EAAAC,EAAAC,EAAAC,EACpB,MAAM,OAAEC,IAAWC,EAAAA,EAAAA,MACb,QAAEC,GAAYF,GACd,EAAEG,IAAMC,EAAAA,EAAAA,MACRC,GAAWC,EAAAA,EAAAA,KACXC,EAASC,eAAeC,QAAQ,QAC/BC,EAAcC,IAAmBC,EAAAA,EAAAA,UAAS,CAAEC,MAAO,GAAIC,IAAKC,OAAOR,IAAW,EAAGS,KAAM,KACvFC,EAAQC,IAAaN,EAAAA,EAAAA,UAAc,CAAEO,SAAU,GAAIC,OAAQ,MAC5D,kBAAEC,EAAiB,gBAAEC,EAAe,UAAEC,EAAS,WAAEC,IAAeC,EAAAA,EAAAA,IAAgBC,GAAUA,EAAMC,UAEhGC,EAAkC,IAArBlB,EAAaI,IAAYO,EAAoBC,EAC1DO,EAA2B,QAAfjC,EAAAgC,EAAWE,YAAI,IAAAlC,GAAfA,EAAiBmC,OAASC,KAAKC,KAAKL,EAAWM,MAAQ,IAAM,EACzEC,EAAczB,EAAaM,MAAQa,GAAaA,EAAY,EAG5DO,EAAW,WAMX,IALJZ,EAAmBa,UAAAN,OAAA,QAAAO,IAAAD,UAAA,IAAAA,UAAA,GACnBE,EAAqBF,UAAAN,OAAA,QAAAO,IAAAD,UAAA,IAAAA,UAAA,GACrBrB,EAAYqB,UAAAN,OAAA,QAAAO,IAAAD,UAAA,GAAAA,UAAA,GAAG3B,EAAaM,KAC5BH,EAAawB,UAAAN,OAAA,QAAAO,IAAAD,UAAA,GAAAA,UAAA,GAAG3B,EAAaG,MAC7BC,EAAWuB,UAAAN,OAAA,QAAAO,IAAAD,UAAA,GAAAA,UAAA,GAAG3B,EAAaI,IAEvByB,IACF/B,eAAegC,QAAQ,cAAe,KACtC7B,GAAe8B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI/B,GAAY,IAAEG,QAAOC,MAAKE,KAAM,KACrDX,GAASqC,EAAAA,EAAAA,GAAmB,uBAE9BrC,GAASsC,EAAAA,EAAAA,IAAkB,CAAEpB,WAAW,EAAMC,aAAYe,kBAC1DK,YAAW,KAEPvC,EADU,IAARS,GACO+B,EAAAA,EAAAA,IAA2B,CAAE7B,OAAM8B,aAAcjC,KAGxDkC,EAAAA,EAAAA,IAAyB,CACvB/B,KAAMA,EACNgC,aAAcnC,EACdoC,KAAMhC,EAAOE,SACbC,OAAQH,EAAOG,UAIrBZ,eAAegC,QAAQ,cAAeU,OAAOlC,GAAM,GAClD,IACL,GAGAmC,EAAAA,EAAAA,YAAU,KACRf,GAAU,GACT,CAACnB,IAiBJ,OACEmC,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAC,SAAA,CACG/B,IAAagC,EAAAA,EAAAA,KAACC,EAAAA,EAAO,KACtBJ,EAAAA,EAAAA,MAAA,OAAKK,UAAU,mEAAkEH,SAAA,EAC/EC,EAAAA,EAAAA,KAACG,EAAAA,GAAM,CAACC,KAAMnD,eAAeC,QAAQ,aAAe,OACpD8C,EAAAA,EAAAA,KAAA,KAAGE,UAAU,wBAAuBH,SAAEnD,EAAE,yCAE1CiD,EAAAA,EAAAA,MAAA,OAAKK,UAAU,2CAA0CH,SAAA,EACvDC,EAAAA,EAAAA,KAAA,SACEK,KAAK,OACLH,UAAU,8FACVI,YAAa1D,EAAE,yBACf2D,MAAOpD,EAAaG,MACpBkD,SAAWC,GAAMrD,GAAiBsD,IAASxB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAWwB,GAAI,IAAEpD,MAAOmD,EAAEE,OAAOJ,UAC5EK,UAAYH,IACI,UAAVA,EAAEI,KAAiBhC,GAAS,GAAO,EAAO,EAAI4B,EAAEE,OAA4BJ,MAAM,KAG1FP,EAAAA,EAAAA,KAACc,EAAAA,EAAU,CAACZ,UAAU,4FACrB/C,EAAaG,QACZ0C,EAAAA,EAAAA,KAACe,EAAAA,EAAS,CACRb,UAAU,0FACVc,QAASA,IAAMnC,GAAS,GAAO,EAAO,EAAG,UAI/CmB,EAAAA,EAAAA,KAAA,OAAKE,UAAU,yDAAwDH,SACpE,CAAC,qBAAO,gBAAMkB,KAAI,CAACC,EAAGC,KACrBnB,EAAAA,EAAAA,KAAA,KAEEE,UAAS,cAAAkB,OACPjE,EAAaI,MAAQ4D,EAAI,EAAI,8DAAgE,IAE/FH,QAASA,KAAMK,OAtCvBxC,GAAS,GAAO,EAAO,EAAG,GADJtB,EAuCgB4D,EAAI,GArC1ClE,eAAegC,QAAQ,MAAOU,OAAOpC,SACrCH,GAAe8B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI/B,GAAY,IAAEI,SAHbA,KAuCuB,EAAAwC,SAEpCmB,GANIA,OAUW,IAArB/D,EAAaI,KACZyC,EAAAA,EAAAA,KAAAF,EAAAA,SAAA,CAAAC,UACyB,QAAtBzD,EAAAwB,EAAkBS,YAAI,IAAAjC,OAAA,EAAtBA,EAAwBkC,QAAS,GAChCV,EAAkBS,KAAK0C,KAAI,CAACC,EAAQC,KAClCnB,EAAAA,EAAAA,KAACsB,EAAAA,GAAI,CAACC,GAAE,2BAAAH,OAA6BF,EAAEM,IAAKzB,UAC1CF,EAAAA,EAAAA,MAAA,OACEK,UAAS,6DACTuB,MAAO,CAAEC,gBAAgB,OAADN,QAAgB,OAAPzE,QAAO,IAAPA,OAAO,EAAPA,EAASgF,UAAWT,EAAEU,iBAAgB,MAAM7B,SAAA,EAE7EC,EAAAA,EAAAA,KAAA,OAAKE,UAAU,gDACfL,EAAAA,EAAAA,MAAA,OAAKK,UAAU,kCAAiCH,SAAA,EAC9CC,EAAAA,EAAAA,KAAA,OAAKE,UAAU,QAAOH,UACpBC,EAAAA,EAAAA,KAAA,OACE6B,KAAY,OAAPlF,QAAO,IAAPA,OAAO,EAAPA,EAASgF,UAAWT,EAAEY,cAC3BC,IAAKb,EAAEM,GACPQ,QAAQ,OACRC,OAASxB,IACQA,EAAEE,OACVc,MAAMS,QAAU,GAAG,EAE5BC,QAAU1B,IACOA,EAAEE,OACVkB,IAAM,2BAA2B,EAE1C3B,UAAU,+BACVuB,MAAO,CACLS,QAAS,IACTE,WAAY,iCAIlBvC,EAAAA,EAAAA,MAAA,OAAKK,UAAU,QAAOH,SAAA,EACpBC,EAAAA,EAAAA,KAAA,KAAGE,UAAU,iCAAgCH,SAAEmB,EAAEmB,eACjDxC,EAAAA,EAAAA,MAAA,QAAMK,UAAU,eAAcH,SAAA,CAC3BmB,EAAEoB,YACF1F,EAAE,+BA/BqCuE,QAwCxDtB,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAC,SAAA,EACEC,EAAAA,EAAAA,KAACuC,EAAAA,EAAU,CAAC3F,EAAGA,EAAG4F,YAAazE,EAAgB0E,QAAS/E,OAAQA,EAAQC,UAAWA,KACnFqC,EAAAA,EAAAA,KAAC0C,EAAAA,EAAW,CAACnE,KAAMR,EAAgBQ,KAAM5B,QAASA,QAGtDkD,EAAAA,EAAAA,MAAA,OAAKK,UAAU,wDAAuDH,SAAA,EACpD,QAAfxD,EAAA8B,EAAWE,YAAI,IAAAhC,OAAA,EAAfA,EAAiBiC,QAAS,GAAKR,IAAagC,EAAAA,EAAAA,KAAA,OAAK6B,IAAI,sBAAsBE,IAAI,UAAUY,MAAM,UAChF,QAAfnG,EAAA6B,EAAWE,YAAI,IAAA/B,OAAA,EAAfA,EAAiBgC,QAAS,IACxBI,GACCoB,EAAAA,EAAAA,KAAA,UACEgB,QAASA,IA3GE4B,MACrB,IAAKhE,EAAa,OAClB,MAAMiE,EAAe5F,eAAeC,QAAQ,eACtC4F,EAAWtF,OAAOqF,GAAgB,EACxCzF,GAAe8B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAI/B,GAAY,IAAEM,KAAMqF,KACzCjE,GAAS,GAAM,EAAOiE,EAAS,EAsGNF,GACf1C,UAAU,uEAAsEH,SAE/EnD,EAAE,sBAGLoD,EAAAA,EAAAA,KAAA,KAAGE,UAAU,oBAAmBH,SAAEnD,EAAE,wBAG1CoD,EAAAA,EAAAA,KAAC+C,EAAAA,EAAM,MACN,C,yDCnLP,SAAeC,EAAAA,EAAAA,IAA2BhD,EAAAA,EAAAA,KAAK,OAAQ,CACrDkB,EAAG,0GACD,Q,yDCFJ,SAAe8B,EAAAA,EAAAA,IAA2BhD,EAAAA,EAAAA,KAAK,OAAQ,CACrDkB,EAAG,sOACD,S","sources":["pages/Library/Library.tsx","../node_modules/@mui/icons-material/esm/Close.js","../node_modules/@mui/icons-material/esm/Search.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport { useGlobalConfig } from \"../../GlobalContext\";\nimport { useAppDispatch, useAppSelector } from \"../../store/hooks\";\nimport { useTranslation } from \"react-i18next\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport TopBtn from \"../../components/Common/TopBtn\";\nimport SearchIcon from \"@mui/icons-material/Search\";\nimport Loading from \"../../components/Common/Loading\";\nimport SelectMenu from \"../../components/Library/SelectMenu\";\nimport CreatorList from \"../../components/Library/CreatorList\";\nimport { FETCH_CREATOR_AUTHOR_THUNK, FETCH_CREATOR_WORK_THUNK } from \"../../actions/creatorAction\";\nimport { CLEAR_CREATOR_LIST, LOAD_CREATOR_LIST } from \"../../reducers/creatorReducer\";\nimport { GoBack } from \"../../Hooks\";\n\nconst Library = () => {\n  const { config } = useGlobalConfig();\n  const { setting } = config;\n  const { t } = useTranslation();\n  const dispatch = useAppDispatch();\n  const libTab = sessionStorage.getItem(\"lib\");\n  const [searchConfig, setSearchConfig] = useState({ query: \"\", tab: Number(libTab) || 1, page: 1 });\n  const [filter, setFilter] = useState<any>({ language: \"\", source: \"\" });\n  const { creatorAuthorList, creatorWorkList, isLoading, isLoadMore } = useAppSelector((state) => state.creator);\n\n  const currentTab = searchConfig.tab === 1 ? creatorAuthorList : creatorWorkList;\n  const pageLimit = currentTab.list?.length ? Math.ceil(currentTab.total / 30) : 0;\n  const hasNextPage = searchConfig.page <= pageLimit && pageLimit > 1;\n\n  // GetList\n  const loadList = (\n    isLoadMore: boolean = false,\n    isRefreshing: boolean = false,\n    page: number = searchConfig.page,\n    query: string = searchConfig.query,\n    tab: number = searchConfig.tab\n  ) => {\n    if (isRefreshing) {\n      sessionStorage.setItem(\"catLoadMore\", \"1\");\n      setSearchConfig({ ...searchConfig, query, tab, page: 1 });\n      dispatch(CLEAR_CREATOR_LIST(\"creatorAuthorList\"));\n    }\n    dispatch(LOAD_CREATOR_LIST({ isLoading: true, isLoadMore, isRefreshing }));\n    setTimeout(() => {\n      if (tab === 1) {\n        dispatch(FETCH_CREATOR_AUTHOR_THUNK({ page, search_query: query }));\n      } else {\n        dispatch(\n          FETCH_CREATOR_WORK_THUNK({\n            page: page,\n            search_value: query,\n            lang: filter.language,\n            source: filter.source,\n          })\n        );\n      }\n      sessionStorage.setItem(\"libLoadMore\", String(page));\n    }, 500);\n  };\n\n  // lang & source\n  useEffect(() => {\n    loadList();\n  }, [filter]);\n\n  // loading more\n  const handleLoadMore = () => {\n    if (!hasNextPage) return;\n    const loadMorePage = sessionStorage.getItem(\"libLoadMore\");\n    const nextPage = Number(loadMorePage) + 1;\n    setSearchConfig({ ...searchConfig, page: nextPage });\n    loadList(true, false, nextPage);\n  };\n\n  const handleClickTab = (tab: number) => {\n    loadList(false, false, 1, \"\", tab);\n    sessionStorage.setItem(\"lib\", String(tab));\n    setSearchConfig({ ...searchConfig, tab });\n  };\n\n  return (\n    <>\n      {isLoading && <Loading />}\n      <div className=\"sticky top-0 h-20 bg-bbk text-white flex items-end p-2 py-3 z-50\">\n        <GoBack back={sessionStorage.getItem(\"fromPage\") || \"/\"} />\n        <p className=\"ml-4 text-2xl text-og\">{t(\"library.forbidden_comic_library\")}</p>\n      </div>\n      <div className=\"relative w-full flex justify-cneter my-4\">\n        <input\n          type=\"text\"\n          className=\"relative m-auto w-11/12 h-12 border-none outline-none rounded-full text-gy px-9 dark:bg-nbk\"\n          placeholder={t(\"search.search_keyword\")}\n          value={searchConfig.query}\n          onChange={(e) => setSearchConfig((prev: any) => ({ ...prev, query: e.target.value }))}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\") loadList(false, false, 1, (e.target as HTMLInputElement).value);\n          }}\n        />\n        <SearchIcon className=\"absolute left-7 top-1/2 transform -translate-y-1/2 text-[#aaa] text-2xl stroke-gray-400\" />\n        {searchConfig.query && (\n          <CloseIcon\n            className=\"absolute right-8 top-1/2 transform -translate-y-1/2 text-[#aaa] text-xl stroke-gray-400\"\n            onClick={() => loadList(false, false, 1, \"\")}\n          />\n        )}\n      </div>\n      <div className=\"w-full flex justify-around text-center text-lg text-gy\">\n        {[\"創作者\", \"作品\"].map((d, i) => (\n          <p\n            key={d}\n            className={`w-1/2 py-4 ${\n              searchConfig.tab === i + 1 ? \"bg-white text-og font-bold border-b-4 border-og dark:bg-nbk\" : \"\"\n            }`}\n            onClick={() => handleClickTab(i + 1)}\n          >\n            {d}\n          </p>\n        ))}\n      </div>\n      {searchConfig.tab === 1 ? (\n        <>\n          {creatorAuthorList.list?.length > 0 &&\n            creatorAuthorList.list.map((d: any, i: any) => (\n              <Link to={`/library/list?creatorId=${d.id}`} key={i}>\n                <div\n                  className={`relative bg-cover bg-center overflow-hidden px-4 py-2 my-2`}\n                  style={{ backgroundImage: `url(${setting?.img_host + d.background_image})` }}\n                >\n                  <div className=\"absolute inset-0 bg-gray-900 bg-opacity-60\"></div>\n                  <div className=\"flex items-center relative z-10\">\n                    <div className=\"w-2/6\">\n                      <img\n                        src={setting?.img_host + d.author_avatar}\n                        alt={d.id}\n                        loading=\"lazy\"\n                        onLoad={(e) => {\n                          const target = e.target as HTMLImageElement;\n                          target.style.opacity = \"1\";\n                        }}\n                        onError={(e) => {\n                          const target = e.target as HTMLImageElement;\n                          target.src = \"/images/title-circle.webp\";\n                        }}\n                        className=\"w-32 object-cover rounded-xl\"\n                        style={{\n                          opacity: \"0\",\n                          transition: \"opacity 0.5s ease-in-out\",\n                        }}\n                      />\n                    </div>\n                    <div className=\"w-4/6\">\n                      <p className=\"text-og text-2xl font-bold p-3\">{d.author_name}</p>\n                      <span className=\"text-tgy p-3\">\n                        {d.update_date}\n                        {t(\"library.update\")}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </Link>\n            ))}\n        </>\n      ) : (\n        <>\n          <SelectMenu t={t} filtersList={creatorWorkList.filters} filter={filter} setFilter={setFilter} />\n          <CreatorList list={creatorWorkList.list} setting={setting} />\n        </>\n      )}\n      <div className=\"flex flex-col justify-center items-center my-10 pb-40\">\n        {currentTab.list?.length > 0 && isLoading && <img src=\"/images/loading.gif\" alt=\"loading\" width=\"80px\" />}\n        {currentTab.list?.length > 0 &&\n          (hasNextPage ? (\n            <button\n              onClick={() => handleLoadMore()}\n              className=\"w-4/12 rounded-sm text-white p-2 bg-og shadow-lg shadow-stone-700/50\"\n            >\n              {t(\"comic.load_more\")}\n            </button>\n          ) : (\n            <p className=\"text-center mt-10\">{t(\"comic.no_more\")}</p>\n          ))}\n      </div>\n      <TopBtn />\n    </>\n  );\n};\n\nexport default Library;\n","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n}), 'Close');","\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14\"\n}), 'Search');"],"names":["Library","_currentTab$list","_creatorAuthorList$li","_currentTab$list2","_currentTab$list3","config","useGlobalConfig","setting","t","useTranslation","dispatch","useAppDispatch","libTab","sessionStorage","getItem","searchConfig","setSearchConfig","useState","query","tab","Number","page","filter","setFilter","language","source","creatorAuthorList","creatorWorkList","isLoading","isLoadMore","useAppSelector","state","creator","currentTab","pageLimit","list","length","Math","ceil","total","hasNextPage","loadList","arguments","undefined","isRefreshing","setItem","_objectSpread","CLEAR_CREATOR_LIST","LOAD_CREATOR_LIST","setTimeout","FETCH_CREATOR_AUTHOR_THUNK","search_query","FETCH_CREATOR_WORK_THUNK","search_value","lang","String","useEffect","_jsxs","_Fragment","children","_jsx","Loading","className","GoBack","back","type","placeholder","value","onChange","e","prev","target","onKeyDown","key","SearchIcon","CloseIcon","onClick","map","d","i","concat","handleClickTab","Link","to","id","style","backgroundImage","img_host","background_image","src","author_avatar","alt","loading","onLoad","opacity","onError","transition","author_name","update_date","SelectMenu","filtersList","filters","CreatorList","width","handleLoadMore","loadMorePage","nextPage","TopBtn","createSvgIcon"],"sourceRoot":""}